<!doctype html><html lang=en-us><head><meta charset=utf-8><title>How to Integrate Virtual Machines into Istio Service Mesh · BIS</title><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1"><meta name=description content="Better integration of virtual machine-based workloads into the service mesh is a major focus for the Istio team this year, and Tetrate also provides seamless multi-cloud connectivity, security and observability, including for virtual machines, through its product Tetrate Service Bridge. This article will show you why Istio needs to integrate with virtual machines and how."><meta name=author content="BIS"><meta name=generator content="Hugo 0.101.0"><link rel=stylesheet href=/sdmxio/plugins/bootstrap/bootstrap.min.css><link rel=stylesheet href=/sdmxio/plugins/slick/slick.css><link rel=stylesheet href=/sdmxio/plugins/animate/animate.css><link rel=stylesheet href=/sdmxio/plugins/venobox/venobox.css><link rel=stylesheet href=/sdmxio/plugins/themify-icons/themify-icons.css><link rel=stylesheet href=/sdmxio/plugins/hightlight/syntax.css><link rel=stylesheet href=/sdmxio/plugins/tocbot/tocbot.css><link rel=stylesheet href=/sdmxio/plugins/bigger-picture/bigger-picture.css><link rel=stylesheet href=/sdmxio/plugins/fontawesome-pro-5.0.13/svg-with-js/css/fa-svg-with-js.css><link rel=stylesheet href=/sdmxio/scss/style.css media=screen><link rel=icon href=/sdmxio/favicon.png type=image/png><link rel=apple-touch-icon href=/sdmxio/apple-touch-icon.png><link rel=apple-touch-icon sizes=57x57 href=images/favicon-57.png><link rel=apple-touch-icon sizes=72x72 href=images/favicon-72.png><link rel=apple-touch-icon sizes=114x114 href=images/favicon-114.png><link rel=apple-touch-icon sizes=144x144 href=images/favicon-144.png><link href=/opensearchdescription.xml rel=search title='Content search' type=application/opensearchdescription+xml><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.3/docsearch.min.css><meta name=twitter:card content="summary_large_image"><meta name=twitter:site content="sdmx.io"><meta name=twitter:creator content="@sdmx.io"><meta property="og:url" content="https://glennmdt.github.io/sdmxio/blog/how-to-integrate-virtual-machines-into-istio-service-mesh/"><meta property="og:title" content="How to Integrate Virtual Machines into Istio Service Mesh"><meta property="twitter:title" content="How to Integrate Virtual Machines into Istio Service Mesh"><meta property="og:description" content="Better integration of virtual machine-based workloads into the service mesh is a major focus for the Istio team this year, and Tetrate also provides seamless multi-cloud connectivity, security and observability, including for virtual machines, through its product Tetrate Service Bridge. This article will show you why Istio needs to integrate with virtual machines and how."><meta property="twitter:description" content="Better integration of virtual machine-based workloads into the service mesh is a major focus for the Istio team this year, and Tetrate also provides seamless multi-cloud connectivity, security and observability, including for virtual machines, through its product Tetrate Service Bridge. This article will show you why Istio needs to integrate with virtual machines and how."><meta property="og:image" content="https://glennmdt.github.io/sdmxio/images/banner/istio-logo.webp"><meta property="twitter:image" content="https://glennmdt.github.io/sdmxio/images/banner/istio-logo.webp"></head><body><button onclick=topFunction() id=backTopBtn title="Go to top"><i class="fa fa-arrow-circle-up" aria-hidden=true></i></button><header class="fixed-top header"><div class="navigation w-100"><div class=container><nav class="navbar navbar-expand-lg navbar-light p-0"><a class=navbar-brand href=/sdmxio><img class=img-fluid width=200px src=/sdmxio/images/logo.png alt="Open source software for official statistics"></a>
<button class="navbar-toggler rounded-0" type=button data-toggle=collapse data-target=#navigation aria-controls=navigation aria-expanded=false aria-label="Toggle navigation">
<span class=navbar-toggler-icon></span></button><div class="collapse navbar-collapse text-center" id=navigation><ul class="navbar-nav ml-auto"><li class="nav-item dropdown"><a class="nav-link dropdown-toggle" href=# role=button data-toggle=dropdown aria-haspopup=true aria-expanded=false>About</a><div class=dropdown-menu><a class=dropdown-item href=/sdmxio/about>ABOUT SDMX.IO</a>
<a class=dropdown-item href=/sdmxio/community>COMMUNITY</a>
<a class=dropdown-item href=/sdmxio/governance>GOVERNANCE</a></div></li><li class="nav-item dropdown"><a class="nav-link dropdown-toggle" href=# role=button data-toggle=dropdown aria-haspopup=true aria-expanded=false>Ecosystem</a><div class=dropdown-menu><a class=dropdown-item href=/sdmxio/ecosystem>ECOSYSTEM</a>
<a class=dropdown-item href=/sdmxio/fmr>FUSION METADATA REGISTRY</a></div></li><li class=nav-item><a class=nav-link href=/sdmxio/blog>Articles</a></li><li class=nav-item><a class=nav-link href=/sdmxio/event>Events</a></li><li class=nav-item><a class=nav-link href=/sdmxio/learn>Learn</a></li><li class=nav-item><a class=nav-link href=/sdmxio/notice>Notices</a></li><li class="nav-item dropdown"><a class="nav-link dropdown-toggle" href=# role=button data-toggle=dropdown aria-haspopup=true aria-expanded=false>Help</a><div class=dropdown-menu><a class=dropdown-item href=https://github.com/glennmdt/sdmxio/issues>ISSUES ON GITHUB</a></div></li><li class=nav-item><a class=nav-link href=/sdmxio/contact>Contact</a></li></ul></div></nav></div></div></header><section class="bg-cover page-title-section overlay" style=background-image:url(/sdmxio/images/backgrounds/page-title.webp),url(/sdmxio/images/backgrounds/page-title.webp)><div class=container><div class=row><div class=col-md-8><ul class="list-inline custom-breadcrumb"><li class="list-inline-item h2"><a class="text-white font-secondary" href=/sdmxio/blog>Blogs</a></li><li class=list-inline-item><i class="ti-angle-right text-white"></i></li><li class="list-inline-item text-white h3 font-secondary">How to Integrate Virtual Machines Into Istio Service Mesh</li></ul><p class=text-white>Better integration of virtual machine-based workloads into the service mesh is a major focus for the Istio team this year, and Tetrate also provides seamless multi-cloud connectivity, security and observability, including for virtual machines, through its product Tetrate Service Bridge. This article will show you why Istio needs to integrate with virtual machines and how.</p></div></div></div></section><section class=section-sm><div class="container blog"><div class=row><div class="col-lg-8 article-content"><div class=row><div class=col-12><ul class=list-inline><li class="list-inline-item mr-4 mb-3 mb-md-0 text-light"><span class="font-weight-bold mr-2">Date
:</span>November 2, 2020</li><li class="list-inline-item mr-4 mb-3 mb-md-0 text-light"><span class="font-weight-bold mr-2">Category
:</span><a href=/sdmxio/categories/istio>
Istio</a></li><li class="list-inline-item mr-4 mb-3 mb-md-0 text-light"><span class="font-weight-bold mr-2">Word Count
:</span>859 words</li><li class="list-inline-item mr-4 mb-3 mb-md-0 text-light"><span class="font-weight-bold mr-2">Reading Time
:</span>4 Minute</li></ul></div><div class="col-12 my-4"><div class=border-bottom></div></div><div class="col-12 content"><p><a href=https://istio.io/ title=Istio target=_blank rel=noopener>Istio</a>
is a popular service mesh to connect, secure, control, and observe services. When it was first introduced as open source in 2017, Kubernetes was winning the container orchestration battle and Istio answered the needs of organizations moving to microservices. Although Istio claims to support heterogeneous environments such as Nomad, Consul, Eureka, Cloud Foundry, Mesos, etc., in reality, it has always worked best with Kubernetes — on which its service discovery is based.</p><p>Istio was criticized for a number of issues early in its development, for the large number of components, the complexity of installation and maintenance, the difficulty of debugging, a steep learning curve due to the introduction of too many new concepts and objects (up to 50 CRDs), and the impact of Mixer components on performance. But these issues are gradually being overcome by the Istio team. As you can see from the <a href=https://istio.io/latest/zh/blog/2020/tradewinds-2020/ title=roadmap target=_blank rel=noopener>roadmap</a>
released in early 2020, Istio has come a long way.</p><p>Better integration of VM-based workloads into the mesh is a major focus for the Istio team this year. Tetrate also offers seamless multicloud connectivity, security, and observability, including for VMs, via its product <a href=https://www.tetrate.io/tetrate-service-bridge/ title="Tetrate Service Bridge" target=_blank rel=noopener>Tetrate Service Bridge</a>
. This article will take you through why Istio needs to integrate with virtual machines and how you can do so.</p><h2 id=why-should-istio-support-virtual-machines>Why Should Istio Support Virtual Machines?</h2><p>Although containers and Kubernetes are now widely used, there are still many services deployed on virtual machines and APIs outside of the Kubernetes cluster that needs to be managed by Istio mesh. It’s a huge challenge to unify the management of the brownfield environment with the greenfield.</p><h2 id=what-is-needed-to-add-vms-to-the-mesh>What Is Needed to Add VMs to the Mesh?</h2><p>Before the “how,” I’ll describe <em>what</em> is needed to add virtual machines to the mesh. There are a couple of things that Istio must know when supporting virtual machine traffic: which VMs have services that should be part of the mesh, and how to reach the VMs. Each VM also needs an identity, in order to communicate securely with the rest of the mesh. These requirements could work with Kubernetes CRDs, as well as a full-blown Service Registry like Consul. And the service account based identity bootstrapping could work as a mechanism for assigning workload identities to VMs that do not have a platform identity. For VMs that do have a platform identity (like EC2, GCP, Azure, etc.), work is underway in Istio to exchange the platform identity with a Kubernetes identity for ease of setting up mTLS communication.</p><h2 id=how-does-istio-support-virtual-machines>How Does Istio Support Virtual Machines?</h2><p>Istio’s support for virtual machines starts with its service registry mechanism. The information about services and instances in the Istio mesh comes from Istio’s service registries, which up to this point have only looked at or tracked pods. In newer versions, Istio now has resource types to track and watch VMs. The sidecars inside the mesh cannot observe and control traffic to services outside the mesh, because they do not have any information about them.</p><p>The Istio community and <a href=https://www.tetrate.io/ title=Tetrate target=_blank rel=noopener>Tetrate</a>
have done a lot of <a href=https://www.tetrate.io/blog/istio-bringing-vms-into-the-mesh-with-cynthia-coan/ title=work target=_blank rel=noopener>work</a>
on Istio’s support for virtual machines. The 1.6 release included the addition of WorkloadEntry, which allows you to describe a VM exactly as you would a host running in Kubernetes. In 1.7, the release started to add the foundations for bootstrapping VMs into the mesh automatically through tokens, with Istio doing the heavy lifting. Istio 1.8 will debut another abstraction called WorkloadGroup, which is similar to a Kubernetes Deployment object — but for VMs.</p><p>The following diagram shows how Istio models services in the mesh. The predominant source of information comes from a platform service registry like Kubernetes, or a system like Consul. In addition, the ServiceEntry serves as a user-defined service registry, modeling services on VMs or external services outside the organization.</p><p><figure class="mx-auto text-center"><img src=/sdmxio/blog/how-to-integrate-virtual-machines-into-istio-service-mesh/0081Kckwgy1gkp0fvr3orj30p30ehabc.jpg data-img=/sdmxio/blog/how-to-integrate-virtual-machines-into-istio-service-mesh/0081Kckwgy1gkp0fvr3orj30p30ehabc.jpg data-width=903 data-height=521 alt=0081Kckwgy1gkp0fvr3orj30p30ehabc.jpg data-caption><figcaption></figcaption></figure></p><p><strong>Why install Istio in a virtual machine when you can just use ServiceEntry to bring in the services in the VMs?</strong></p><p>Using ServiceEntry, you can enable services inside the mesh to discover and access external services; and in addition, manage the traffic to those external services. In conjunction with VirtualService, you can also configure access rules for the corresponding external service — such as request timeouts, fault injection, etc. — to enable controlled access to the specified external service.</p><p>Even so, it only controls the traffic on the client-side, not access to the introduced external service to other services. That is, it cannot control the behavior of the service as the call initiator. Deploying sidecars in a virtual machine and introducing the virtual machine workload via workload selector allows the virtual machine to be managed indiscriminately, like a pod in Kubernetes.</p><h2 id=future>Future</h2><p>As you can see from the <a href=https://istio.io/latest/docs/examples/virtual-machines/bookinfo/ title="bookinfo demo" target=_blank rel=noopener>bookinfo demo</a>
, there is too much manual work involved in the process and it’s easy to go wrong. In the future, Istio will improve VM testing to be realistic, automate bootstrapping based on platform identity, improve DNS support and istioctl debugging, and more. You can follow the <a href=https://github.com/istio/community/blob/master/WORKING-GROUPS.md title="Istio Environment Working Group" target=_blank rel=noopener>Istio Environment Working Group</a>
for more details about virtual machine support.</p><h2 id=references>References</h2><ul><li><a href=https://istio.io/latest/docs/setup/install/virtual-machine/ title="Virtual Machine Installation" target=_blank rel=noopener>Virtual Machine Installation</a></li><li><a href=https://istio.io/latest/docs/examples/virtual-machines/single-network/ title="Virtual Machines in Single-Network Meshes" target=_blank rel=noopener>Virtual Machines in Single-Network Meshes</a></li><li><a href=https://www.tetrate.io/blog/istio-bringing-vms-into-the-mesh-with-cynthia-coan/ title="Istio: Bringing VMs into the Mesh (with Cynthia Coan)" target=_blank rel=noopener>Istio: Bringing VMs into the Mesh (with Cynthia Coan)</a></li><li><a href=https://www.tetrate.io/blog/bridging-traditional-and-modern-workloads/ title="Bridging Traditional and Modern Workloads" target=_blank rel=noopener>Bridging Traditional and Modern Workloads</a></li></ul></div><div class="col-12 mb-4"><div class=border-bottom><p class=edit-page><a href=https://github.com/sdmxio/website/edit/master/content/en/blog/how-to-integrate-virtual-machines-into-istio-service-mesh/index.md><i class="fa fa-pencil-square-o" aria-hidden=true></i> Edit this page</a></p></div></div><div class=col-12><li class="list-inline-item mr-4 mb-3 mb-md-0 text-light"></li></div><div class=col-12><ul class="pager blog-pager"><li class=previous><a href=https://glennmdt.github.io/sdmxio/blog/cloud-native-and-me-the-past-current-and-future/ data-toggle=tooltip data-placement=top title="Cloud Native and me - the past, current and future">&larr; Previous Post</a></li><li class=next><a href=https://glennmdt.github.io/sdmxio/blog/istio-1-8-a-smart-dns-proxy-takes-support-for-virtual-machines-a-step-further/ data-toggle=tooltip data-placement=top title="Istio 1.8: A Smart DNS Proxy Takes Support for Virtual Machines a Step Further">Next Post &rarr;</a></li></ul></div><div class=col-12></div></div></div><aside class="col-lg-4 sidebar"><div class="bg-white mb-4"><p class=sidebar-title>Categories</p><ul class=list-unstyled><li class=border-bottom><a href=/sdmxio/categories/cloud-native class="d-block pb-3 mt-3 text-capitalize">Cloud native</a></li><li class=border-bottom><a href=/sdmxio/categories/istio class="d-block pb-3 mt-3 text-capitalize">Istio</a></li><li class=border-bottom><a href=/sdmxio/categories/tools class="d-block pb-3 mt-3 text-capitalize">Tools</a></li></ul></div><div class=bg-white><p class=sidebar-title>Tags</p><div id=tag-cloud><a href=/tags/cncf style=font-size:.8rem>Cncf</a>
<a href=/tags/ecosystem style=font-size:.8rem>Ecosystem</a>
<a href=/tags/fmr style=font-size:.8rem>Fmr</a>
<a href=/tags/istio style=font-size:1.557115704285749rem>Istio</a>
<a href=/tags/nocalhost style=font-size:.8rem>Nocalhost</a>
<a href=/tags/service-mesh style=font-size:.8rem>Service mesh</a>
<a href=/tags/telepresence style=font-size:.8rem>Telepresence</a></div></div><div class="bg-white py-4 box-shadow mb-4 sticky-top aside-toc d-none d-sm-block"><p class=sidebar-title>Table of content</p><nav id=TableOfContents><ul><li><a href=#why-should-istio-support-virtual-machines>Why Should Istio Support Virtual Machines?</a></li><li><a href=#what-is-needed-to-add-vms-to-the-mesh>What Is Needed to Add VMs to the Mesh?</a></li><li><a href=#how-does-istio-support-virtual-machines>How Does Istio Support Virtual Machines?</a></li><li><a href=#future>Future</a></li><li><a href=#references>References</a></li></ul></nav></div></aside></div></div></section><footer><div class="footer bg-footer section-sm border-bottom"><div class=container><div class=row><div class="col-lg-4 col-sm-8 mb-5 mb-lg-0"><h4 class="text-white mb-5 text-uppercase">Follow sdmx.io</h4><ul class=list-unstyled><li class="mb-4 text-color">Twitter</li></div><div class="col-lg-2 col-md-3 col-sm-4 col-6 mb-5 mb-md-0"><h4 class="text-white mb-5 text-uppercase">Articles</h4><ul class=list-unstyled><li class=mb-3><a class=text-color href=/sdmxio/blog/how-to-build-istio/>How to build Istio?</a></li><li class=mb-3><a class=text-color href=/sdmxio/blog/how-to-debug-microservices-in-kubernetes-with-proxy-sidecar-or-service-mesh/>How to debug microservices in Kubernetes with proxy, sidecar or service mesh?</a></li><li class=mb-3><a class=text-color href=/sdmxio/blog/istio-1-8-a-smart-dns-proxy-takes-support-for-virtual-machines-a-step-further/>Istio 1.8: A Smart DNS Proxy Takes Support for Virtual Machines a Step Further</a></li></ul></div><div class="col-lg-2 col-md-3 col-sm-4 col-6 mb-5 mb-md-0"><h4 class="text-white mb-5 text-uppercase">links</h4><ul class=list-unstyled><li class=mb-3><a class=text-color href=https://www.bis.org/innovation/bis_open_tech_sdmx.htm target=_blank rel=noopener>FMR @ BIS Open Tech</a></li><li class=mb-3><a class=text-color href=https://sdmx.org target=_blank rel=noopener>SDMX</a></li><li class=mb-3><a class=text-color href=https://registry.sdmx.org target=_blank rel=noopener>SDMX Global Registry</a></li></ul></div><div class="col-lg-2 col-md-3 col-sm-4 col-6 mb-5 mb-md-0"><h4 class="text-white mb-5 text-uppercase">new notices</h4><ul class=list-unstyled><li class=mb-3><a class=text-color href=/sdmxio/notice/fmr-11.1.7-release/>FMR 11.1.7 release</a></li></ul></div></div></div></div><div class="copyright py-4 bg-footer"><div class=container><div class=row><div class="col-sm-9 text-sm-left text-center"><p class="mb-0 text-color">© 2022 BIS All Rights Reserved</p></div><div class="col-sm-3 text-sm-right text-center"><ul class=list-inline><li class=list-inline-item><a class="d-inline-block p-2" href=https://twitter.com/sdmxio target=_blank rel=noopener><i class="fa fa-twitter"></i></a></li><li class=list-inline-item><a class="d-inline-block p-2" href=https://github.com/sdmxio target=_blank rel=noopener><i class="fa fa-github"></i></a></li><li class=list-inline-item><a class="d-inline-block p-2" href=https://linkedin.com/in/sdmxio target=_blank rel=noopener><i class="fa fa-linkedin"></i></a></li><li class=list-inline-item><a class="d-inline-block p-2" href=mailto:info@sdmxio.io target=_blank rel=noopener><i class="fa fa-envelope"></i></a></li></ul></div></div></div></div></footer><script src=/sdmxio/plugins/jQuery/jquery.min.js></script>
<script src=/sdmxio/plugins/bootstrap/bootstrap.min.js></script>
<script src=/sdmxio/plugins/slick/slick.min.js></script>
<script src=/sdmxio/plugins/venobox/venobox.min.js></script>
<script src=/sdmxio/plugins/filterizr/jquery.filterizr.min.js></script>
<script src=/sdmxio/plugins/search/fuse.min.js></script>
<script src=/sdmxio/plugins/search/mark.js></script>
<script src=/sdmxio/plugins/search/search.js></script>
<script src=/sdmxio/plugins/hex_md5/hex_md5.js></script>
<script src=/sdmxio/plugins/anchor/anchor.min.js></script>
<script src=/sdmxio/plugins/tocbot/tocbot.min.js></script>
<script src=/sdmxio/plugins/bigger-picture/bigger-picture.min.js></script>
<script src=/sdmxio/plugins/fontawesome-pro-5.0.13/svg-with-js/js/fontawesome-all.min.js></script>
<script src=/sdmxio/js/script.min.js></script><meta name=baidu-site-verification content="g8IYR9SNLF"><script src=https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.3/docsearch.min.js></script>
<script>docsearch({apiKey:"d7f7189aef2be4e5be6a6b9f44897f61",indexName:"DocSearch",appId:"CRNDR5CNMU",inputSelector:"#js-algolia-btn",debug:!1})</script><script>tocbot.init({tocSelector:"#TableOfContents",contentSelector:".content",headingSelector:"h1, h2, h3, h4",hasInnerContainers:!1,collapseDepth:3})</script></body></html>